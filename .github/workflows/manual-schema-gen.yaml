name: schema-gen-manual-from-secrets

on:
  workflow_dispatch:
    inputs:
      start_path:
        description: 'Starting path (space seperated)'
        required: false
#      release_tag:
#        description: 'Release tag'
#        required: true
#      release_name:
#        description: 'Release name'
#        required: true
#      release_body:
#        description: 'Release description'
#        required: true

jobs:
  run-bun:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v3

    - name: Setup Bun Runtime
      uses: oven-sh/setup-bun@v1
      with:
        bun-version: 'latest' 

    - name: Run RAML Generator Code with Bun
      run: |
        bun install js-yaml raml2html raml2html-slate-theme
        bun rest2raml.js ${{ github.event.inputs.start_path }}
        find . -name raml2html
        ./node_modules/.bin/raml2html --theme raml2html-slate-theme ros-rest*.raml > ros-rest-generated.html
      env:
        URLBASE: https://${{ secrets.ROS_HOST}}/rest 
        BASICAUTH: ${{ secrets.ROS_USER }}:${{ secrets.ROS_PASSWD }} 

    - name: Save Build Artifacts
      uses: actions/upload-artifact@v4
      with:
        name: build-results
        path: |
          ros-rest*
          ros-inspect*
          ros-rest-generated*
